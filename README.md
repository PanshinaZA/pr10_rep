# Практическая работа №10. Аналитика с использованием сложных типов данных. Поиск и анализ продаж.

## Цель:
Создать проверенную внутреннюю поисковую систему, которая сделает всех клиентов доступными для поиска по их контактной информации и продуктам, которые они приобрели в прошлом.

## Ход работы:
1. Используя таблицу customer_sales, создайте доступное для поиска представление с одной записью для каждого клиента. Это представлениедолжно быть отключено от столбца customer_id и доступно для поиска по всей базе данных, что связано с этим клиентом:

• имя,

• адрес электронной почты,

• телефон,

• приобретенные продукты.

![image](https://github.com/user-attachments/assets/8aade679-50e9-40e4-be50-1e952e7e1c77)
![image](https://github.com/user-attachments/assets/a1776938-f471-4ec5-b780-08f0dac237d6)

2. Создайте доступный для поиска индекс, созданного вами ранее представления.

![image](https://github.com/user-attachments/assets/b09a5309-602e-471b-bf56-a40c59197f3e)
![image](https://github.com/user-attachments/assets/8a3985fe-4d01-4870-8d79-2745291d47ed)

3. У кулера с водой продавец спрашивает, можете ли вы использовать свой новый поисковый прототип, чтобы найти покупателя по имени Дэнни, купившего скутер Bat. Запросите новое представление с возможностью поиска, используя ключевые слова «Danny Bat». Какое количество строк вы получили?

![image](https://github.com/user-attachments/assets/5f5c8b1b-06a3-47f1-92f5-b6a3ad6d0ac0)

4. Отдел продаж хочет знать, насколько часто люди покупают скутер и автомобиль. Выполните перекрестное соединение таблицы продуктов с самой собой, чтобы получить все отдельные пары продуктов и удалить одинаковые пары (например, если название продукта совпадает). Для каждой пары выполните поиск в представлении, чтобы узнать, сколько клиентов соответствует обоим продуктам в паре. Можно предположить, что выпуски ограниченной серии можно сгруппировать вместе с их аналогом стандартной модели (например, Bat и Bat Limited Edition можно считать одним и тем же скутером).

Для начала выведем уникальный список скутеров и автомобилей:

![image](https://github.com/user-attachments/assets/0ef23ac6-4a6a-4f90-b9cd-511651fdab01)

Затем сделаем то же самое, но используем функцию plainto_tsquery для полнотекстового поиска:

![image](https://github.com/user-attachments/assets/705cd2a6-e8f8-4530-85a9-7454d458b5ec)

Узнаем сколько клиентов соответствует обоим продуктам в паре:

![image](https://github.com/user-attachments/assets/5d22f8c7-4a2b-416b-aa33-b9cb2a334443)

`pr10_task.sql` - файл с выполненными sql-запросами

## Выводы:
В ходе выполнения лабораторной работы успешно создана поисковая система, которая делает всех клиентов доступными для поиска по их контактной информации и продуктам, которые они приобрели в прошлом.
